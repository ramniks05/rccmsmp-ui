<div class="container-fluid py-4">
  <div class="row">
    <!-- Calendar Section -->
    <div class="col-lg-8 col-md-7 mb-4">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <div class="d-flex justify-content-between align-items-center">
            <button class="btn btn-light btn-sm" (click)="previousMonth()">
              <i class="bi bi-chevron-left"></i> Previous
            </button>
            <h4 class="mb-0">
              {{ monthNames[currentMonth] }} {{ currentYear }}
            </h4>
            <button class="btn btn-light btn-sm" (click)="nextMonth()">
              Next <i class="bi bi-chevron-right"></i>
            </button>
          </div>
        </div>

        <div class="card-body p-0">
          <div class="calendar-grid">
            <!-- Week Days -->
            <div class="week-days">
              <div class="week-day" *ngFor="let day of weekDays">
                {{ day }}
              </div>
            </div>

            <!-- Calendar Days -->
            <div class="calendar-days">
              <div
                class="calendar-day"
                *ngFor="let day of calendarDays"
                [class.other-month]="!day.isCurrentMonth"
                [class.today]="day.isToday"
                [class.has-events]="hasEvents(day.date)"
                (click)="onDateClick(day)"
              >
                <div class="day-number">{{ day.day }}</div>

                <div
                  class="event-indicators"
                  *ngIf="hasEvents(day.date) && day.isCurrentMonth"
                >
                  <span
                    class="event-dot"
                    *ngFor="let event of getEventsForDate(day.date)"
                    [class.event-dot-holiday]="event.eventType === 'HOLIDAY'"
                    [class.event-dot-event]="event.eventType === 'EVENT'"
                    [title]="event.title"
                  ></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Upcoming Events -->
    <div class="col-lg-4 col-md-5">
      <div class="card shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0">
            <i class="bi bi-calendar-event"></i> Upcoming Events & Holidays
          </h5>
        </div>

        <div class="card-body p-0">
          <div class="upcoming-list">
            <div
              class="upcoming-item"
              *ngFor="let event of getUpcomingEvents()"
              [class.holiday-item]="event.eventType === 'HOLIDAY'"
              [class.event-item]="event.eventType === 'EVENT'"
            >
              <div class="d-flex justify-content-between">
                <div>
                  <span
                    class="badge me-2"
                    [class.bg-danger]="event.eventType === 'HOLIDAY'"
                    [class.bg-info]="event.eventType === 'EVENT'"
                  >
                    {{ event.eventType === 'HOLIDAY' ? 'HOLIDAY' : 'EVENT' }}
                  </span>
                  <strong>{{ event.title }}</strong>

                  <div class="text-muted small mt-1">
                    <i class="bi bi-calendar3"></i>
                    {{ formatDate(event.date) }}
                  </div>

                  <p class="small mb-0" *ngIf="event.description">
                    {{ event.description }}
                  </p>
                </div>

                <button
                  class="btn btn-sm btn-outline-danger"
                  (click)="deleteEvent(event)"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>

            <div
              *ngIf="getUpcomingEvents().length === 0"
              class="text-center p-4 text-muted"
            >
              <i class="bi bi-calendar-x fs-1"></i>
              <p>No upcoming events or holidays</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Legend -->
      <div class="card shadow-sm mt-3">
        <div class="card-body">
          <h6>Legend</h6>
          <div class="d-flex align-items-center mb-2">
            <span class="event-dot event-dot-event me-2"></span> Event
          </div>
          <div class="d-flex align-items-center mb-2">
            <span class="event-dot event-dot-holiday me-2"></span> Holiday
          </div>
          <div class="d-flex align-items-center">
            <div class="today-indicator me-2"></div> Today
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ================= MODAL ================= -->

<div
  class="modal"
  [class.show]="showModal"
  [style.display]="showModal ? 'block' : 'none'"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          {{ isEditMode ? 'Edit Event / Holiday' : 'Add Event / Holiday' }}
        </h5>
        <button class="btn-close" (click)="closeModal()"></button>
      </div>

      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Selected Date</label>
          <input
            class="form-control"
            [value]="selectedDate ? formatDate(selectedDate) : ''"
            readonly
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Type</label>
          <select class="form-select" [(ngModel)]="eventType">
            <option *ngFor="let item of eventTypeList" [value]="item.value">
              {{ item.label }}
            </option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label">
            Title <span class="text-danger">*</span>
          </label>
          <input
            class="form-control"
            [(ngModel)]="eventTitle"
            placeholder="Enter title"
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Description</label>
          <textarea
            class="form-control"
            rows="3"
            [(ngModel)]="eventDescription"
          ></textarea>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">
          Cancel
        </button>
        <button
          class="btn btn-primary"
          (click)="saveEvent()"
          [disabled]="!eventTitle.trim()"
        >
          {{ isEditMode ? 'Update' : 'Save' }}
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="modal-backdrop fade"
  [class.show]="showModal"
  *ngIf="showModal"
></div>
